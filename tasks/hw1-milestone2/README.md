# Домашнее задание 1. Часть 2. [3 балла]

**Решения принимаются до 26 сентября включительно**.

## Задача

Добавить в сервис, реализованный в первой части ДЗ, поддержку MongoDB для хранения данных.

Также необходимо добавить дополнительный эндпоинт `/maintenance/ping`
для определения готовности сервиса к работе (см. обновленный [microblog.yaml](./microblog.yaml))
Гарантируется, что тесты не стартуют до тех пор, пока сервис не вернёт `200 OK`
с этого эндпоинта.

## Рекоммендации

- если вы не делали [первую часть](../hw1-milestone1) домашки, начните с неё. 
  Баллов вы за это уже не получите, но это будет хорошим стартом. 
  Jenkins-пайплайн для проверки первой домашки всё еще доступен. 

- во время старта сервиса в режиме `mongo` создайте индекс для оптимального поиска постов автора.
  Про оптимизацию пагинации с помощью индексов можно почитать в материалах к [5-му занятию](../../mongo-intro-4).

## Формат сдачи

- Сервис должен быть оформлен в виде git-репозитория с реализацией на Go.
  В корне репозитория должен находиться ``Dockerfile``, описывающий образ сервиса.

- Репозиторий должен быть **приватным**, read-доступ к нему необходимо предоставить 3-м пользователям:
    - [hse-system-design-bot](https://github.com/hse-system-design-bot) -- без этого сборка в Jenkins не случится!
    - [ADKosm](https://github.com/ADKosm)
    - [lfyuomr-gylo](https://github.com/lfyuomr-gylo)

  **NOTE**: если вы сдавали первую часть, пожалуйста, используйте те же репозитории. Если вы не сдавали домашку,
  **озаботьтесь созданием репозитория заранее**, чтобы не опоздать к дедлайну из-за того, 
  что hse-system-design-bot (в лице Льва) не принял инвайт, который вы отправили в 23:30 в воскресенье.
  SLA приёма инвайтов --- 24 часа.

- При запуске Docker-образа сервис должен автоматически стартовать в соответствии с установленными переменными
  окружения:

  - `SERVER_PORT` --- номер порта, на котором должен быть доступен API
  - `STORAGE_MODE` --- режим хранения постов, возможно одно из двух значений:
      - `inmemory` --- хранение в памяти (в этом режиме сервис должен себя вести так же, как в первом задании)
      - `mongo` --- хранение в MongoDB. Адрес и название базы данных передаются
        в отдельных переменных окружения (см. ниже)
  - `MONGO_URL` --- адрес для подключения к MongoDB
  - `MONGO_DBNAME` --- название базы данных, которую можно использовать для хранения.

- Критерий сдачи --- успешная сборка Jenkins-джобы http://178.154.220.128/job/hw1-milestone2/build
  (логин `student` пароль `student1234!`)

- Успешную сборку нужно сохранить, нажав кнопку "Хранить эту сборку вечно",
  и загрузить в форму https://forms.gle/piyM4Hj7z2cT4p4JA
